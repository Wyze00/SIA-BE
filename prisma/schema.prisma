generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  mahasiswa
  dosen
  admin
}

enum Jurusan {
  informatika
  dkv
  industri
  akuntansi
  olb
  management
  si
}

enum StatusMatkul {
  diambil
  dibatalkan
  lulus
  gagal
}

model User {
  id       String @id @db.VarChar(10)
  role     Role
  password String @db.VarChar(100)
  name     String @db.VarChar(100)

  admin     Admin?
  dosen     Dosen?
  mahasiswa Mahasiswa?

  @@map("users")
}

model Mahasiswa {
  nim              String               @id @db.VarChar(10)
  jurusan          Jurusan
  semester         Int                  @db.TinyInt
  name             String               @db.VarChar(100)
  angkatan         String               @db.Char(4)
  user             User                 @relation(fields: [nim], references: [id])
  mahasiswa_matkul MhsMengambilMatkul[]

  @@map("mahasiswa")
}

model Dosen {
  nip  String @id @db.VarChar(10)
  name String @db.VarChar(100)
  user User   @relation(fields: [nip], references: [id])

  matkul Matkul[]

  @@map("dosen")
}

model Admin {
  id_admin   String @id @db.VarChar(10)
  departemen String @db.VarChar(100)
  name       String @db.VarChar(100)
  user       User   @relation(fields: [id_admin], references: [id])

  @@map("admin")
}

model Matkul {
  kode_matkul     String @id @db.VarChar(10)
  dosen_nip       String @db.VarChar(10)
  name            String @db.VarChar(50)
  total_pertemuan Int
  total_sks       Int

  dosen            Dosen                @relation(fields: [dosen_nip], references: [nip])
  mahasiswa_matkul MhsMengambilMatkul[]

  @@map("matkul")
}

model MhsMengambilMatkul {
  kode_matkul String       @db.VarChar(10)
  nim         String       @db.VarChar(10)
  semester    Int
  nilai_huruf String?      @db.Char(2)
  status      StatusMatkul

  matkul    Matkul    @relation(fields: [kode_matkul], references: [kode_matkul])
  mahasiswa Mahasiswa @relation(fields: [nim], references: [nim])

  @@id([kode_matkul, nim])
  @@map("mahasiswa_ambil_matkul")
}
